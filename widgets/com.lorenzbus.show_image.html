<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  </head>
    <body>
        <div class="container">
            
            <span id="spanSource" style="display:none"></span>
            <img id="imgDisplay"></img>

        </div>
        <script src="//code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
        <script src="//stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
        <script src="//js.jotform.com/JotFormCustomWidget.min.js"></script>
        <script>
            $(function () {
                console.log('com.lorenzbus.show_image.page_load')

                // const spanSource = document.getElementById('spanSource');
                const imgDisplay = document.getElementById('imgDisplay');

                JFCustomWidget.subscribe("ready", function(){
                    console.log('com.lorenzbus.show_image.JFCustomWidget.ready');

                    /*
                    The submit event is triggered when the form's submit button is pressed.
                    */
                    JFCustomWidget.subscribe("submit", function(){
                        console.log('com.lorenzbus.show_image.JFCustomWidget.submit');

                        // structure to be returned
                        var msg = {
                            valid: true,
                            value: imgDisplay.src
                        }
                        console.log('msg',msg)

                        // return what was received
                        JFCustomWidget.sendSubmit(msg);
                    });

                });

                /*
                The populate event is triggered when the widget receives data from the form.
                */
                JFCustomWidget.subscribe('populate', function(data){
                    console.log('com.lorenzbus.show_image.JFCustomWidget.populate');

                    // data
                    console.log('data',data)

                    // set the image's src attribute to the data
                    // https://stackoverflow.com/a/21227124/134367
                    imgDisplay.src = data

                    // structure to be returned
                    var data = {
                        valid: true,
                        value: data
                    }
                    console.log('data',data)

                    // returned what was received
                    JFCustomWidget.sendData(data)
                });

            })
        </script>
    </body>
</html>